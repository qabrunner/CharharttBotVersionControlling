{"triggers":[],"nodes":[{"uid":"2138259c-f70d-4120-bad9-f687bd880007","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"33c92f9c-1bcd-4c6e-9427-92e394d7e253","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"45a75c25-6458-4116-b355-87f9eaab56be","commandName":"runApp","packageName":"Application","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file://Taskkill"}},{"name":"startInPath","value":{"type":"STRING","string":""}},{"name":"parameters","value":{"type":"STRING","string":"/t /IM EXCEL.EXE /f"}}]},{"uid":"eba53bbf-f2de-4bed-bd6d-530c67f5eb0d","commandName":"runApp","packageName":"Application","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file://Taskkill"}},{"name":"startInPath","value":{"type":"STRING","string":""}},{"name":"parameters","value":{"type":"STRING","string":"/t /IM saplogon.exe /f"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Kill opened application sessions if any"}}]},{"uid":"24fb01ee-f9c5-477c-b974-948728ac5a22","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"d54bf581-e6ae-43a0-ad56-7116f4402c3f","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/Indirect%20PO%20Creation/Subtask%20Get%20Config%20Details"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"sInputFolder","value":{"type":"VARIABLE","variableName":"sInputFolder"}},{"key":"sArchiveFolder","value":{"type":"VARIABLE","variableName":"sArchiveFolder"}},{"key":"sOutputFolder","value":{"type":"VARIABLE","variableName":"sOutputFolder"}},{"key":"sLogsFolder","value":{"type":"VARIABLE","variableName":"sLogsFolder"}},{"key":"sErrorSnapshotFolder","value":{"type":"VARIABLE","variableName":"sErrorSnapshotFolder"}},{"key":"sSharepointInputFolder","value":{"type":"VARIABLE","variableName":"sSharepointInputFolder"}},{"key":"sSharepointOutputFolder","value":{"type":"VARIABLE","variableName":"sSharepointOutputFolder"}},{"key":"sUserEmailAddresses","value":{"type":"VARIABLE","variableName":"sUserEmailAddresses"}},{"key":"sAdminEmailAddresses","value":{"type":"VARIABLE","variableName":"sAdminEmailAddresses"}},{"key":"SubTaskErrorFlag","value":{"type":"VARIABLE","variableName":"SubTaskErrorFlag"}},{"key":"ErrorMessage","value":{"type":"VARIABLE","variableName":"ErrorMessage"}},{"key":"ErrorLineNumber","value":{"type":"VARIABLE","variableName":"ErrorLineNumber"}},{"key":"sSAPLoginEnvironment","value":{"type":"VARIABLE","variableName":"sSAPLoginEnvironment"}},{"key":"sAuditLogFile","value":{"type":"VARIABLE","variableName":"sAuditLogFile"}},{"key":"sTimestamp","value":{"type":"VARIABLE","variableName":"sTimestamp"}}]}},{"uid":"d5fb88cb-cfb9-4b04-babe-52e616205d37","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"d903b808-f331-4c89-8a3b-3e3827943991","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sAuditLogFile$"}},{"name":"logContent","value":{"type":"STRING","expression":"Failed in Read Config Details | $ErrorMessage$ at $ErrorLineNumber.Number:toString$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"d435cfd5-df59-4343-8e2e-25e86e389585","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"BOOLEAN","expression":"$SubTaskErrorFlag$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"BOOLEAN","boolean":true}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"booleanVariable","packageName":"Boolean"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Read Config Details"}}]},{"uid":"59c4735b-eb19-410a-9046-c3c9ab897803","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"4de0a9f3-0032-448b-ab4d-2e9c111bbd11","commandName":"SendMailV2","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$sAdminEmailAddresses$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"invalidAddress","value":{"type":"BOOLEAN","boolean":false}},{"name":"subject","value":{"type":"STRING","expression":"Indirect PO Creation Bot Initiated - $sTimestamp$"}},{"name":"fileList","value":{"type":"LIST","list":[]}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Hi All,\n\nThe Indirect PO Creation bot initiated at $sTimestamp$.\n\nRegards,\nIndirect PO Creation Bot\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"OUTLOOK"}}]},{"uid":"ec179d5b-827d-45bd-86dd-e7bd405f76b1","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sAuditLogFile$"}},{"name":"logContent","value":{"type":"STRING","expression":"Master Task | Bot initiated email sent to admin ($sAdminEmailAddresses$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Send Bot Initiation Email"}}]},{"uid":"2316af68-79ad-4baf-a831-8634e7498c88","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"24e3329c-65f9-4d96-bd5b-7cc176ff8a62","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"4696bde9-3e0a-4353-bffc-ccd20b295e5e","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"65252804-8491-41cf-bd1e-f916137c7fd2","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"e5f355d7-2dd2-4e1f-a376-ca620bc8251f","commandName":"copyFiles","packageName":"File","disabled":false,"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$sSharepointInputFolder$/$dSharepointInputFile{name}$.$dSharepointInputFile{extension}$"}},{"name":"destinationPath","value":{"type":"STRING","expression":"$sInputFolder$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}},{"name":"isParallel","value":{"type":"BOOLEAN","boolean":false}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$dSharepointInputFile{extension}$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","string":"xls"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"dSharepointInputFile"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sSharepointInputFolder$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.files","packageName":"File"}}]}],"branches":[{"uid":"ed3d1fc1-49ae-46e7-9c77-3676ba1540c9","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"5a7df635-fbf4-42b0-bad6-828e829d9fd0","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sAuditLogFile$"}},{"name":"logContent","value":{"type":"STRING","expression":"Failed in Reading Each File in Sharepoint Input Folder | $ErrorMessage$ at $ErrorLineNumber.Number:toString$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"5e9e12b5-2b2c-4d5f-91bf-7a4eab17e529","commandName":"SendMailV2","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$sAdminEmailAddresses$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"invalidAddress","value":{"type":"BOOLEAN","boolean":false}},{"name":"subject","value":{"type":"STRING","expression":"Indirect PO Creation Bot Failed - $sTimestamp$"}},{"name":"fileList","value":{"type":"LIST","list":[{"type":"FILE","expression":"file://$sAuditLogFile$"}]}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Hi All,\n\nThe Indirect PO Creation Bot failed in looping files from sharepoint input folder.\nError: $ErrorMessage$ at $ErrorLineNumber.Number:toString$\n\nRegards,\nIndirect PO Creation Bot"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"OUTLOOK"}}]},{"uid":"a51315a6-8cdc-41b8-a219-5f510a9159fe","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":true}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"ErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"ErrorLineNumber"}}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Get the input file from sharepoint"}}]},{"uid":"13b73581-40c3-46af-8021-e17038153551","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"486fd6fe-968d-41d3-8af1-1eac5e49a5ed","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"06a7e417-f5b1-4c28-b409-4f6047e0f9ab","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"6ce2b60e-46be-4dc0-a4ee-068aaaa09ea0","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"debf20c1-5287-4ec9-8754-11acae92d2bb","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"bInputFileExistFlag"}},{"uid":"e6181a72-c07b-46ec-ae24-69c78e84be13","commandName":"loop.commands.break","packageName":"Loop","disabled":false,"attributes":[]}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$dInputFile{extension}$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","string":"xls"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"dInputFile"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sInputFolder$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.files","packageName":"File"}}]}],"branches":[{"uid":"4ab69e65-af4c-445a-8cd1-46412b5161a0","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"bb83c8f0-d35b-4d79-b91e-c8cb31594c8b","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sAuditLogFile$"}},{"name":"logContent","value":{"type":"STRING","expression":"Failed in Reading Each File in Local Input Folder | $ErrorMessage$ at $ErrorLineNumber.Number:toString$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"f08c83ac-45cb-4ef2-a450-5b18b237f02b","commandName":"SendMailV2","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$sAdminEmailAddresses$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"invalidAddress","value":{"type":"BOOLEAN","boolean":false}},{"name":"subject","value":{"type":"STRING","expression":"Indirect PO Creation Bot Failed - $sTimestamp$"}},{"name":"fileList","value":{"type":"LIST","list":[{"type":"FILE","expression":"file://$sAuditLogFile$"}]}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Hi All,\n\nThe Indirect PO Creation Bot failed in looping files from local input folder.\nError: $ErrorMessage$ at $ErrorLineNumber.Number:toString$\n\nRegards,\nIndirect PO Creation Bot"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"OUTLOOK"}}]},{"uid":"734b8f72-cdf1-4aa4-bc83-6c5690d4be25","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Input File Exist in Local Input Folder"}}]},{"uid":"4060d1e3-5b6c-4449-948a-dcbc759824e9","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"a36d34b9-b6af-4f64-8b06-2a00fb58e1aa","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"ac52b0eb-c942-4122-b9b2-ed7edebe470e","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"5981bbfd-e18f-484e-bef7-576604867c5d","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sAuditLogFile$"}},{"name":"logContent","value":{"type":"STRING","string":"Master Task | Start Login to SAP."}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"ea28177d-2e85-43e3-a4a1-0bf0cd01f039","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"sSAPLoginEnvironment","value":{"type":"STRING","expression":"$sSAPLoginEnvironment$"}},{"key":"sAuditLogFile","value":{"type":"STRING","expression":"$sAuditLogFile$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/Indirect%20PO%20Creation/Subtask_SAPLogin"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"ErrorMessage","value":{"type":"VARIABLE","variableName":"ErrorMessage"}},{"key":"ErrorLineNumber","value":{"type":"VARIABLE","variableName":"ErrorLineNumber"}},{"key":"SubTaskErrorFlag","value":{"type":"VARIABLE","variableName":"SubTaskErrorFlag"}}]}},{"uid":"9c80a234-e72f-4d3e-a29b-9ff5c3b6f28f","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"7021004b-19a1-4264-89b0-fd9eac653f57","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sAuditLogFile$"}},{"name":"logContent","value":{"type":"STRING","expression":"Failed in login to SAP | $ErrorMessage$ at $ErrorLineNumber.Number:toString$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"8d740cdd-e3e5-4160-9f35-555c73079044","commandName":"SendMailV2","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$sAdminEmailAddresses$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"invalidAddress","value":{"type":"BOOLEAN","boolean":false}},{"name":"subject","value":{"type":"STRING","expression":"Indirect PO Creation Bot Failed - $sTimestamp$"}},{"name":"fileList","value":{"type":"LIST","list":[{"type":"FILE","expression":"file://$sAuditLogFile$"}]}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Hi All,\n\nThe Indirect PO Creation Bot failed to login to SAP.\nError: $ErrorMessage$ at $ErrorLineNumber.Number:toString$\n\nRegards,\nIndirect PO Creation Bot"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"OUTLOOK"}}]},{"uid":"bb2760ad-8e55-4c9a-b1da-8737080ca3da","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"branches":[{"uid":"78d18566-4edd-493e-a258-3248b75f0512","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"debfa2d0-1f6a-4aa3-8888-e1558992040c","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"fb0326ee-16df-44cb-b811-55405eb35491","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"5aabc68b-ad60-4728-876b-17663602936a","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sAuditLogFile$"}},{"name":"logContent","value":{"type":"STRING","expression":"Master Task | Input File: $dInputFile{name}$.$dInputFile{extension}$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"018aade2-6b93-4298-8b0f-28a075967151","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"12221a39-7e0b-4a56-ab2f-768c0d35e20b","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"39530f62-cd1a-4c9c-b970-aa82f37bbeb6","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sInputFolder$\\$dInputFile{name}$.$dInputFile{extension}$"}}],"returnTo":{"type":"VARIABLE","variableName":"sInputFilePath"}},{"uid":"c44f0334-4d8a-4c1d-a4ad-739a8b80617f","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dInputFile{name}$.$dInputFile{extension}$"}}],"returnTo":{"type":"VARIABLE","variableName":"sInputFileName"}},{"uid":"2f2f6b2d-0616-48f0-a4ea-c52154cf5871","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"4396ed1b-48da-47e5-885a-4ce158385828","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sAuditLogFile$"}},{"name":"logContent","value":{"type":"STRING","expression":"Subtask PO Creation starts | Input File: $dInputFile{name}$.$dInputFile{extension}$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"eb4e5b6d-7bed-42cd-b96a-a63cb965752d","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"sInputFilePath","value":{"type":"STRING","expression":"$sInputFilePath$"}},{"key":"sAuditLogFile","value":{"type":"STRING","expression":"$sAuditLogFile$"}},{"key":"sOutputFolder","value":{"type":"STRING","expression":"$sOutputFolder$"}},{"key":"sTimeStamp","value":{"type":"STRING","expression":"$sTimeStamp$"}},{"key":"sInputFileName","value":{"type":"STRING","expression":"$sInputFileName$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/Indirect%20PO%20Creation/Subtask_POCreation"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"ErrorMessage","value":{"type":"VARIABLE","variableName":"ErrorMessage"}},{"key":"ErrorLineNumber","value":{"type":"VARIABLE","variableName":"ErrorLineNumber"}},{"key":"SubTaskErrorFlag","value":{"type":"VARIABLE","variableName":"SubTaskErrorFlag"}}]}},{"uid":"ed4f5e69-bd46-4b79-893f-402130d1c573","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sAuditLogFile$"}},{"name":"logContent","value":{"type":"STRING","expression":"Subtask PO Creation ends | Input File: $dInputFile{name}$.$dInputFile{extension}$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"db8f2b71-760c-4b99-9ae8-db480b169edc","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"60373b33-30ca-4ff4-a896-1356ed5a7e06","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sAuditLogFile$"}},{"name":"logContent","value":{"type":"STRING","expression":"Failed in PO Creation Task | $ErrorMessage$ at $ErrorLineNumber.Number:toString$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"8ac71693-68c9-4c89-a606-03091173c198","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"be4b37c7-0e09-4812-8daa-66d255d8b9bb","commandName":"copyFiles","packageName":"File","disabled":false,"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$sInputFolder$/$dInputFile{name}$.$dInputFile{extension}$"}},{"name":"destinationPath","value":{"type":"STRING","expression":"$sSharepointOutputFolder$\\$dInputFile{name}$_$sTimeStamp$.$dInputFile{extension}$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}},{"name":"isParallel","value":{"type":"BOOLEAN","boolean":false}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"025f89d5-28e7-47be-b164-2426f774d2b7","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sAuditLogFile$"}},{"name":"logContent","value":{"type":"STRING","expression":"Master Task | Input File: $dInputFile{name}$.$dInputFile{extension}$ moved to sharepoint output folder: $sSharepointOutputFolder$\\$dInputFile{name}$_$sTimeStamp$.$dInputFile{extension}$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"e10bebaf-c224-4160-a68c-e167bf68832a","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"3ad218c3-20ed-42bd-b4d3-7bc65717eedd","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sSharepointInputFolder$/$dInputFile{name}$.$dInputFile{extension}$"}},{"name":"isParallelDelete","value":{"type":"BOOLEAN","boolean":false}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"e62ba338-c597-47ca-9c1c-d121720faebe","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sAuditLogFile$"}},{"name":"logContent","value":{"type":"STRING","expression":"Master Task | Deleted the file $dInputFile{name}$.$dInputFile{extension}$ from the sharepoint input folder."}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[],"attributes":[{"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$sSharepointInputFolder$/$dInputFile{name}$.$dInputFile{extension}$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"1"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"fileExists","packageName":"File"}}]},{"uid":"77ef06f2-42c0-4d9f-942a-8386353f6273","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sInputFolder$/$dInputFile{name}$.$dInputFile{extension}$"}},{"name":"isParallelDelete","value":{"type":"BOOLEAN","boolean":false}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"3e5cf70e-a64a-4e95-8737-f7bd3c52255f","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sAuditLogFile$"}},{"name":"logContent","value":{"type":"STRING","expression":"Master Task | Deleted the file $dInputFile{name}$.$dInputFile{extension}$ from the local input folder."}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"BOOLEAN","expression":"$SubTaskErrorFlag$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"BOOLEAN","boolean":true}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"booleanVariable","packageName":"Boolean"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Loop through each PO Details in input file And Create PO inside SAP"}}]}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$dInputFile{extension}$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","string":"xls"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"branches":[{"uid":"bf3dde6d-e0f4-452b-807a-1ba325fb96cc","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"c68924bc-5e41-4741-8b1d-35ce4d44b6e3","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sAuditLogFile$"}},{"name":"logContent","value":{"type":"STRING","expression":"Master Task | Error: $ErrorMessage$ at $ErrorLineNumber.Number:toString$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":true}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"ErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"ErrorLineNumber"}}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"dInputFile"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sInputFolder$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.files","packageName":"File"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Loop each file in Local input folder"}}]}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"BOOLEAN","expression":"$SubTaskErrorFlag$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"BOOLEAN","boolean":true}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"booleanVariable","packageName":"Boolean"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Open SAP if not opened already"}}]}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"BOOLEAN","expression":"$bInputFileExistFlag$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"BOOLEAN","boolean":true}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"booleanVariable","packageName":"Boolean"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Start processing the input files"}}]},{"uid":"9e613037-a55b-4007-a94a-55155681ade1","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"8ab09659-a8dd-44f5-8add-3db14b9b3c74","commandName":"runApp","packageName":"Application","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file://Taskkill"}},{"name":"startInPath","value":{"type":"STRING","string":""}},{"name":"parameters","value":{"type":"STRING","string":"/t /IM saplogon.exe /f"}}]},{"uid":"30b203e2-c12a-4a81-aba5-2194e0aa8afe","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sAuditLogFile$"}},{"name":"logContent","value":{"type":"STRING","string":"Master Task | Closed SAP"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"92a71063-a85a-41e8-8a6a-7c5852e97a2c","commandName":"SendMailV2","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$sUserEmailAddresses$"}},{"name":"cc","value":{"type":"STRING","expression":"$sAdminEmailAddresses$"}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"invalidAddress","value":{"type":"BOOLEAN","boolean":false}},{"name":"subject","value":{"type":"STRING","expression":"Indirect PO Creation Bot Finished Execution - $sTimestamp$"}},{"name":"fileList","value":{"type":"LIST","list":[{"type":"FILE","expression":"file://$sOutputFolder$/RunSummary_$sTimestamp$.csv"},{"type":"FILE","expression":"file://$sAuditLogFile$"}]}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","string":"Hi All,\n\nPlease find the Indirect PO Creation bot run summary report.\n\nRegards,\nIndirect PO Creation Bot"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"OUTLOOK"}}]},{"uid":"f37c7388-6222-46aa-b052-27a1e203c163","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sAuditLogFile$"}},{"name":"logContent","value":{"type":"STRING","expression":"Master Task | Bot finished execution email sent to users ($sUserEmailAddresses$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Send Bot executed email"}}]}],"branches":[{"uid":"0c0ad0fa-98a8-456a-881f-2c47ab80510c","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"09cb7bde-ed79-411e-a5b2-87cfd810c09a","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sAuditLogFile$"}},{"name":"logContent","value":{"type":"STRING","expression":"Master Task | Error: $ErrorMessage$ at Line $ErrorLineNumber.Number:toString$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":true}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"ErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"ErrorLineNumber"}}},{"uid":"a8fe8447-1f9c-4299-9a82-53ff2922d24f","commandName":"finally","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"23cec7eb-d5a9-41d6-bca5-794ea6dc0691","commandName":"SendMailV2","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$sAdminEmailAddresses$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"invalidAddress","value":{"type":"BOOLEAN","boolean":false}},{"name":"subject","value":{"type":"STRING","expression":"Indirect PO Creation Bot Finished Execution - $sTimestamp$"}},{"name":"fileList","value":{"type":"LIST","list":[{"type":"FILE","expression":"file://$sAuditLogFile$"}]}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Hi All,\n\nThe Indirect PO Creation bot finished execution.\nError (If Any): $ErrorMessage$ at Line $ErrorLineNumber.Number:toString$\n\nRegards,\nIndirect PO Creation Bot\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"OUTLOOK"}}]},{"uid":"67efea16-9f89-4028-a696-dcb7ed6e4681","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sAuditLogFile$"}},{"name":"logContent","value":{"type":"STRING","expression":"Master Task | Bot initiated email sent to admin ($sAdminEmailAddresses$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}]}]}],"variables":[{"type":"NUMBER","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false,"name":"SampleNumber"},{"type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false,"name":"SampleString"},{"name":"sInputFolder","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"sArchiveFolder","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"sOutputFolder","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"sLogsFolder","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"sErrorSnapshotFolder","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"ConfigFolder","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"sSharepointInputFolder","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"sSharepointOutputFolder","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"sUserEmailAddresses","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"sAdminEmailAddresses","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"SubTaskErrorFlag","type":"BOOLEAN","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"ErrorMessage","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"ErrorLineNumber","type":"NUMBER","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"dSharepointInputFile","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"bInputFileExistFlag","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"dInputFile","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"sSAPLoginEnvironment","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"sAuditLogFile","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"sInputFileName","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sInputFilePath","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sTimestamp","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false}],"packages":[{"name":"Application","version":"3.9.0","settingsAttributes":[]},{"name":"Boolean","version":"2.11.0","settingsAttributes":[]},{"name":"Email","version":"3.23.2","settingsAttributes":[]},{"name":"ErrorHandler","version":"2.12.1-20231117-175338","settingsAttributes":[]},{"name":"File","version":"6.11.0","settingsAttributes":[]},{"name":"If","version":"3.7.14-20231116-000453","settingsAttributes":[]},{"name":"LogToFile","version":"3.8.0","settingsAttributes":[]},{"name":"Loop","version":"3.8.1-20231117-175130","settingsAttributes":[]},{"name":"Number","version":"3.9.1","settingsAttributes":[]},{"name":"Step","version":"2.6.0","settingsAttributes":[]},{"name":"String","version":"5.10.0","settingsAttributes":[]},{"name":"TaskBot","version":"2.8.0-20230530-152744","settingsAttributes":[]}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"botCodeVersion":"6","improvedNumberSupport":true,"timeout":"0s","automationPriority":"PRIORITY_MEDIUM"}}