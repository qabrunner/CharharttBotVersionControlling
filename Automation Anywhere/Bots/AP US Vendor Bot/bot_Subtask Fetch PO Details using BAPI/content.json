{"triggers":[],"nodes":[{"uid":"f7030720-709a-4f9e-a830-0c4b6889e725","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"ea6fe299-0f6f-428e-a9a2-850e95ecf226","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sMainFolder$\\BAPI Output"}}],"returnTo":{"type":"VARIABLE","variableName":"BAPIOutputFolder"}},{"uid":"a2b76ba8-cedb-4145-bfcb-f6e13b8a2cfd","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"71ed7583-3d12-4713-be33-413d2c42b8fb","commandName":"deleteFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$BAPIOutputFolder$"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$BAPIOutputFolder$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"folderExists","packageName":"Folder"}}]},{"uid":"d597ba50-0683-4c63-bf7a-e75d9681dcaf","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$BAPIOutputFolder$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"c2fff139-b729-46b6-b052-2690d60ee88d","commandName":"sapBapiConnect","packageName":"SAPBAPI","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"Default"}},{"name":"jcoJarPath","value":{"type":"FILE","string":"file:///C:/RPAProcesses/SAP/sapjco3.jar"}},{"name":"jcoDllPath","value":{"type":"FILE","string":"file:///C:/RPAProcesses/SAP/sapjco3.dll"}},{"name":"connectionType","value":{"type":"STRING","string":"CUSTOM_APPLICATION_SERVER"}},{"name":"applicationServerHost","value":{"type":"STRING","string":"eu2qaerpap21.carhartt-nt.carhartt.com"}},{"name":"systemNumber","value":{"type":"STRING","expression":"$@SAPSystemNumber$"}},{"name":"systemID","value":{"type":"STRING","expression":"$@SAPInstanceID$"}},{"name":"client","value":{"type":"STRING","expression":"$@SAPClientNumber$"}},{"name":"language","value":{"type":"STRING","string":"EN"}},{"name":"sapRouter","value":{"type":"STRING","string":""}},{"name":"authenticationType","value":{"type":"STRING","string":"USERNAME_AND_PASSWORD"}},{"name":"userName","value":{"type":"CREDENTIAL","credential":{"name":"SAP Login Details","lockerName":"SAP Locker","attributeName":"EQ2_200_Username"}}},{"name":"userSecureText","value":{"type":"CREDENTIAL","credential":{"name":"SAP Login Details","lockerName":"SAP Locker","attributeName":"EQ2_200_Password"}}}]},{"uid":"172157ce-c5de-40c2-9e60-a16485078195","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sLogFile$"}},{"name":"logContent","value":{"type":"STRING","expression":"Fetch line items from SAP for the PO number $sPONumber$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"ec480528-4606-4eb9-ba0a-74f76926259a","commandName":"sapBapiCreateFunction","packageName":"SAPBAPI","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"Default"}},{"name":"functionAliasName","value":{"type":"STRING","string":"PO_DETAIL"}},{"name":"bapiName","value":{"type":"STRING","string":"BAPI_PO_GETDETAIL"}},{"name":"beginSequence","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"b3cd61ec-995e-4754-8938-f04c60d137eb","commandName":"sapBapiSetField","packageName":"SAPBAPI","disabled":false,"attributes":[{"name":"functionAlias","value":{"type":"STRING","string":"PO_DETAIL"}},{"name":"fieldSource","value":{"type":"STRING","string":"Function"}},{"name":"fieldName","value":{"type":"STRING","string":"PURCHASEORDER"}},{"name":"fieldVaue","value":{"type":"STRING","expression":"$sPONumber$"}},{"name":"sessionName","value":{"type":"STRING","string":"Default"}}]},{"uid":"0d22528b-3cf8-4c8a-a968-b674808b32af","commandName":"sapBapiSetField","packageName":"SAPBAPI","disabled":false,"attributes":[{"name":"functionAlias","value":{"type":"STRING","string":"PO_DETAIL"}},{"name":"fieldSource","value":{"type":"STRING","string":"Function"}},{"name":"fieldName","value":{"type":"STRING","string":"ITEMS"}},{"name":"fieldVaue","value":{"type":"STRING","string":"X"}},{"name":"sessionName","value":{"type":"STRING","string":"Default"}}]},{"uid":"25344440-98ca-4d22-a8d2-975ea48a0675","commandName":"sapBapiInvokeFunction","packageName":"SAPBAPI","disabled":false,"attributes":[{"name":"functionAliasName","value":{"type":"STRING","string":"PO_DETAIL"}},{"name":"endSequence","value":{"type":"BOOLEAN","boolean":true}},{"name":"commitTransaction","value":{"type":"BOOLEAN","boolean":true}},{"name":"sessionName","value":{"type":"STRING","string":"Default"}}]},{"uid":"882be5f9-9c4a-4646-b876-7db063947b1a","commandName":"sapBapiGetTable","packageName":"SAPBAPI","disabled":false,"attributes":[{"name":"functionAliasName","value":{"type":"STRING","string":"PO_DETAIL"}},{"name":"tableName","value":{"type":"STRING","string":"PO_ITEMS"}},{"name":"sessionName","value":{"type":"STRING","string":"Default"}},{"name":"destination","value":{"type":"STRING","string":"Variable"}}],"returnTo":{"type":"VARIABLE","variableName":"POLineItemsTable"}},{"uid":"450c0668-b1ba-4b4f-810a-f086bf6253be","commandName":"writeToFile","packageName":"DataTable","disabled":false,"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"POLineItemsTable"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$BAPIOutputFolder$/$Filename$.csv"}},{"name":"createDirectories","value":{"type":"BOOLEAN","boolean":true}},{"name":"appendToExistingFile","value":{"type":"STRING","string":"overwrite"}},{"name":"rowDelimiter","value":{"type":"STRING","string":"NEW_LINE"}},{"name":"columnDelimiter","value":{"type":"STRING","string":"COMMA"}},{"name":"encoding","value":{"type":"STRING","string":"ansi"}}]},{"uid":"622705e1-830b-49fe-9d77-2cf7b7c8b8f4","commandName":"getNumberOfRows","packageName":"DataTable","disabled":false,"attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"POLineItemsTable"}},{"name":"rowCountSelection","value":{"type":"STRING","string":"nonEmptyRowSelection"}}],"returnTo":{"type":"VARIABLE","variableName":"POLineItemsCount"}},{"uid":"e15e12eb-98c9-4b59-b83d-8ac5bf65e6d5","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$BAPIOutputFolder$\\$Filename$.csv"}}],"returnTo":{"type":"VARIABLE","variableName":"sBAPIOutputCSV"}},{"uid":"7a41bd27-0257-4e92-a3d0-2083fa701405","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"File Name: $Filename$\nNumber of records from SAP - $POLineItemsCount.Number:toString$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]},{"uid":"36e2a3d5-fe6f-4e18-8e8a-edf471dc1a8e","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"40681f0e-7fd9-43c1-8fab-61cb22b6ff9d","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"message","value":{"type":"STRING","string":"Unable to fetch PO line items from SAP or Incorrect PO Number."}},{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$POLineItemsCount$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"NUMBER","number":"0"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"}}]}],"branches":[{"uid":"eaa5d263-2234-4763-968e-4372cf5f2979","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"a4bba0b8-c7e0-43e4-9149-c7225e50257d","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"SubTaskErrorFlag"}}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"ErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"ErrorLineNumber"}}}]}],"variables":[{"type":"NUMBER","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false,"name":"SampleNumber"},{"type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false,"name":"SampleString"},{"name":"ReturnTable1","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"ANY","defaultValue":{"type":"DICTIONARY","dictionary":[{"key":"po_number","value":{"type":"STRING","string":""}}]}},{"name":"OutputTable","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"FilesInFolder","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"CsvTxtRow","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"sPONumber","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sMainFolder","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"BAPIOutputFolder","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"Filename","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sBAPIOutputCSV","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"POLineItemsTable","description":"","type":"TABLE","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"POLineItemsCount","description":"","type":"NUMBER","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"ErrorMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"ErrorLineNumber","description":"","type":"NUMBER","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"SubTaskErrorFlag","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"sLogFile","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":[],"packages":[{"name":"Boolean","version":"2.11.0","settingsAttributes":[]},{"name":"DataTable","version":"4.11.0","settingsAttributes":[]},{"name":"ErrorHandler","version":"2.12.1-20231117-175338","settingsAttributes":[]},{"name":"Folder","version":"6.11.0","settingsAttributes":[]},{"name":"If","version":"3.7.14-20231116-000453","settingsAttributes":[]},{"name":"LogToFile","version":"3.8.0","settingsAttributes":[]},{"name":"MessageBox","version":"3.7.0","settingsAttributes":[]},{"name":"Number","version":"3.9.1","settingsAttributes":[]},{"name":"SAPBAPI","version":"2.11.0","settingsAttributes":[]},{"name":"String","version":"5.10.0","settingsAttributes":[]}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"botCodeVersion":"6","improvedNumberSupport":true,"timeout":"0s","automationPriority":"PRIORITY_MEDIUM"}}