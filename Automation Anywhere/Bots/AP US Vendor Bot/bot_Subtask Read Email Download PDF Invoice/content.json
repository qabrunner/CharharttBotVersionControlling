{"triggers":[],"nodes":[{"uid":"5e94aabf-84c8-492d-b8e8-fa96bf6f18a3","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"35add184-acd7-4af0-a674-6628c523d053","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"30c9f856-67fe-45a4-8c5a-643dd449f42e","commandName":"emailConnect","packageName":"Email","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"EmailSession"}},{"name":"serverType","value":{"type":"STRING","string":"OUTLOOK"}},{"name":"mailbox","value":{"type":"STRING","string":"AP Bot Invoices","label":"AP Bot Invoices"}}]},{"uid":"22d16047-36cd-4c06-80df-4c295012fb0f","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sLogFile$"}},{"name":"logContent","value":{"type":"STRING","string":"Prod: Connected to AP Bot Invoices"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"675d2de5-641b-44eb-9f8f-f40c46ea583c","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"aa485433-c89b-4ffd-ac95-bc249d76bc55","commandName":"emailConnect","packageName":"Email","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"EmailSession"}},{"name":"serverType","value":{"type":"STRING","string":"OUTLOOK"}},{"name":"mailbox","value":{"type":"STRING","string":"AP Bot Test Invoices","label":"AP Bot Test Invoices"}}]},{"uid":"cf44e81e-2fb9-45c5-8f88-007e28bf6414","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sLogFile$"}},{"name":"logContent","value":{"type":"STRING","string":"Test: Connected to AP Bot Test Invoices"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sEnvironment$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"prod"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"86757c74-3277-44c1-b8a0-79d4114eeec4","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"6f27657c-cf57-4063-a06c-d957b5bf48ba","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"01198226-d461-450b-a2ee-ab5616f34144","commandName":"deleteFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sDownloadFolder$"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sDownloadFolder$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"folderExists","packageName":"Folder"}}]},{"uid":"639f66c0-f6b5-4d11-b9da-76b0ad358c2b","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sDownloadFolder$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"438b107d-720e-4008-b77c-4545d4d1a5ae","commandName":"saveAttachment","packageName":"Email","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sDownloadFolder$"}},{"name":"checkOverrwrite","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"297f0497-9137-44f2-95a8-97c24933b358","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$EmailDetails{emailSubject}$"}},{"name":"find","value":{"type":"STRING","string":","}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"EmailSubject"}},{"uid":"b90aadc7-20eb-48de-9aec-e8b5c2fdccf5","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"e7611b1c-f9f4-45b5-a6b3-e803eb69a8fa","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"320ac3fa-440c-403f-adc7-c2dcc180abc4","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"385f5051-5022-4dce-a82d-f63f1c98c396","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sOutputFolder$/ReadEmailDetails.csv"}},{"name":"logContent","value":{"type":"STRING","string":"Email Subject,Email From,Email Received Time,No of Attachments,Attachment Name"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"0929cffa-64dc-4745-be8a-27360e4a4dab","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sOutputFolder$/ReadEmailDetails.csv"}},{"name":"logContent","value":{"type":"STRING","expression":"$EmailSubject$,$EmailDetails{emailFrom}$,$EmailDetails{emailReceivedDate}$,$EmailDetails{emailNoOfAttachments}$,$DownloadedFile{name}$.$DownloadedFile{extension}$ "}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"37058e99-957f-488e-a439-41822d0a44d1","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"32dc2cc9-5070-4a7f-9f9b-b644e44b3063","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sOutputFolder$/ReadEmailDetails.csv"}},{"name":"logContent","value":{"type":"STRING","expression":"$EmailSubject$,$EmailDetails{emailFrom}$,$EmailDetails{emailReceivedDate}$,$EmailDetails{emailNoOfAttachments}$,$DownloadedFile{name}$.$DownloadedFile{extension}$ "}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}]}],"attributes":[{"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$sOutputFolder$/ReadEmailDetails.csv"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"fileNotExists","packageName":"File"}}]},{"uid":"b6a04aee-7dd6-4955-ac87-4dc3ec1635ea","commandName":"copyFiles","packageName":"File","disabled":false,"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$sDownloadFolder$/$DownloadedFile{name}$.$DownloadedFile{extension}$"}},{"name":"destinationPath","value":{"type":"STRING","expression":"$sInputInvoicesFolder$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}},{"name":"isParallel","value":{"type":"BOOLEAN","boolean":false}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$DownloadedFile{extension}$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"pdf"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"DownloadedFile"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sDownloadFolder$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.files","packageName":"File"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"EmailDetails"},"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"EmailSession"}},{"name":"readStatus","value":{"type":"STRING","string":"UNREAD"}},{"name":"folder","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":""}},{"name":"from","value":{"type":"STRING","string":""}},{"name":"messageFormat","value":{"type":"STRING","string":"HTML"}},{"name":"isToUseLocalTimezone","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.email","packageName":"Email"}}]},{"uid":"f7188865-0c89-4028-80fa-7cbb5d816df7","commandName":"closeEmail","packageName":"Email","disabled":false,"attributes":[{"name":"session","value":{"string":"EmailSession","type":"STRING"}}]},{"uid":"8e0c831c-1e69-4ca0-9eb9-2c912e569de7","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"5fdc9739-dc77-478a-ae8f-4268f67bd9f4","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"1d1d32bb-d196-4e62-9ff7-6ee1e8da6c4e","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sInputInvoicesFolder$/$InputFile{name}$.$InputFile{extension}$"}},{"name":"isParallelDelete","value":{"type":"BOOLEAN","boolean":false}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$InputFile{extension}$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":"pdf"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"f16235da-04bb-4e8d-aa65-8390752df7a8","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"b3d66aee-055a-4ab4-b104-c1ed48a95a49","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sInputInvoicesFolder$/Detailspecificatie.pdf"}},{"name":"isParallelDelete","value":{"type":"BOOLEAN","boolean":false}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$sInputInvoicesFolder$/Detailspecificatie.pdf"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"fileExists","packageName":"File"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"InputFile"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sInputInvoicesFolder$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.files","packageName":"File"}}]}],"branches":[{"uid":"dfbbaec9-d199-4559-a437-41e5c5a7ad99","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"51f60094-3784-4809-91bd-d22e7495437c","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"SubTaskErrorFlag"}},{"uid":"33fdff53-afc6-4ec7-bef4-c8811668fe07","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$ErrorMessage$ at $ErrorLineNumber.Number:toString$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"ErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"ErrorLineNumber"}}}]}],"variables":[{"type":"NUMBER","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false,"name":"SampleNumber"},{"type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false,"name":"SampleString"},{"name":"sInputInvoicesFolder","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"InputFile","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"sEnvironment","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"ErrorMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"ErrorLineNumber","description":"","type":"NUMBER","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"sOutputFolder","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"EmailDetails","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"EmailSubject","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sDownloadFolder","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"DownloadedFile","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"SubTaskErrorFlag","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"sLogFile","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":[],"packages":[{"name":"Boolean","version":"2.11.0","settingsAttributes":[]},{"name":"Email","version":"3.22.1","settingsAttributes":[]},{"name":"ErrorHandler","version":"2.12.1-20231117-175338","settingsAttributes":[]},{"name":"File","version":"6.11.0","settingsAttributes":[]},{"name":"Folder","version":"6.11.0","settingsAttributes":[]},{"name":"If","version":"3.7.14-20231116-000453","settingsAttributes":[]},{"name":"LogToFile","version":"3.8.0","settingsAttributes":[]},{"name":"Loop","version":"3.8.1-20231117-175130","settingsAttributes":[]},{"name":"MessageBox","version":"3.7.0","settingsAttributes":[]},{"name":"Number","version":"3.9.1","settingsAttributes":[]},{"name":"String","version":"5.10.0","settingsAttributes":[]}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"botCodeVersion":"6","improvedNumberSupport":true,"timeout":"0s","automationPriority":"PRIORITY_MEDIUM"}}